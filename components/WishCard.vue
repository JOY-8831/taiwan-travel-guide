<template>
    <article class="wish-card" v-bind="$attrs" @click="openModal">
        <h3 class="card-topic">
            {{ nameEN }}
            <span v-if="nameCH && showCH" class="ch-name">CH: {{ nameCH }}</span>
        </h3>
        <button
        class="heart-btn"
        type="button"
        :aria-pressed="isFav ? 'true' : 'false'"
        :aria-label="isFav ? 'Remove from favorites' : 'Add to favorites'"
        @click.stop.prevent="toggleFavorite(item)"
        >
            <svg v-show="!isFav" width="32" height="32" viewBox="0 0 16 14" aria-hidden="true" class="icon-outline">
            <g>
                <rect x="8.70996" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="10.1616" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="11.6133" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="13.0649" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="7.2583" y="2.90349" width="1.45166" height="1.45166" />
                <rect x="5.80664" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="4.3551" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="2.90344" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="1.45178" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="14.5166" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="14.5166" y="2.90349" width="1.45166" height="1.45166" />
                <rect x="14.5166" y="4.35493" width="1.45166" height="1.45166" />
                <rect x="13.0649" y="5.80638" width="1.45166" height="1.45166" />
                <rect x="11.6133" y="7.25829" width="1.45166" height="1.45166" />
                <rect x="10.1616" y="8.71021" width="1.45166" height="1.45166" />
                <rect x="8.70996" y="10.1617" width="1.45166" height="1.45166" />
                <rect x="0.00012207" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="0.00012207" y="2.90349" width="1.45166" height="1.45166" />
                <rect x="0.00012207" y="4.35493" width="1.45166" height="1.45166" />
                <rect x="2.90344" y="7.25829" width="1.45166" height="1.45166" />
                <rect x="1.45178" y="5.80638" width="1.45166" height="1.45166" />
                <rect x="4.3551" y="8.71021" width="1.45166" height="1.45166" />
                <rect x="5.80664" y="10.1617" width="1.45166" height="1.45166" />
                <rect x="7.2583" y="11.6136" width="1.45166" height="1.45166" />
            </g>
            </svg>
            <svg v-show="isFav" width="32" height="32" viewBox="0 0 20 16" aria-hidden="true" class="icon-filled">
            <g>
                <rect x="10.6667" y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4446" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="14.2222" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="16" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="8.88892" y="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="7.11108" y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.3335" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="1.77783" y="0.000133514" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="1.77783" y="1.77797" width="5.33325" height="5.33301" fill="#D18FA1"/>
                <rect x="12.4446" y="1.77797" width="5.33325" height="5.33301" fill="#D18FA1"/>
                <rect x="7.11108" y="3.55526" width="5.33325" height="8.88916" fill="#D18FA1"/>
                <rect x="17.7778" y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="17.7778" y="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="17.7778" y="5.33338" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="16" y="7.11109" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="14.2222" y="8.8888" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4446" y="10.6668" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="10.6667" y="12.4445" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect y="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect y="5.33338" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="3.55542" y="8.88881" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.33325" y="8.88881" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.33325" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4443" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4443" y="8.88875" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="14.2224" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="1.77783" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="3.55542" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.3335" y="10.6668" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="7.11108" y="12.4445" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="8.88892" y="14.2223" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="8.88892" y="12.4445" width="1.77778" height="1.77778" fill="#D18FA1"/>
            </g>
            </svg>
        </button>
        <div class="card-image-wrapper">
            <img
            :src="imageSrc"
            :alt="nameEN"
            class="card-image"
            loading="lazy"
            @error="handleImageError"
            >
        </div>
    </article>

<div v-if="showModal" class="modal-overlay" @click.self="closeModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">
                {{ nameEN }}
                <span v-if="nameCH && showCH" class="ch-name">CH: {{ nameCH }}</span>
            </h2>
            <template v-if="item.City && !item.Code.startsWith('P-') && !item.Code.startsWith('F-')">
                <span class="modal-city">({{ item.City }})</span>
            </template>
           <button
            class="heart-btn"
            type="button"
            :aria-pressed="isFav ? 'true' : 'false'"
            :aria-label="isFav ? 'Remove from favorites' : 'Add to favorites'"
            @click.stop.prevent="toggleFavorite(item)"
            >
            <svg v-show="!isFav" width="32" height="32" viewBox="0 0 16 14" aria-hidden="true" class="icon-outline">
            <g>
                <rect x="8.70996" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="10.1616" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="11.6133" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="13.0649" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="7.2583" y="2.90349" width="1.45166" height="1.45166" />
                <rect x="5.80664" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="4.3551" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="2.90344" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="1.45178" y="0.000137329" width="1.45166" height="1.45166" />
                <rect x="14.5166" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="14.5166" y="2.90349" width="1.45166" height="1.45166" />
                <rect x="14.5166" y="4.35493" width="1.45166" height="1.45166" />
                <rect x="13.0649" y="5.80638" width="1.45166" height="1.45166" />
                <rect x="11.6133" y="7.25829" width="1.45166" height="1.45166" />
                <rect x="10.1616" y="8.71021" width="1.45166" height="1.45166" />
                <rect x="8.70996" y="10.1617" width="1.45166" height="1.45166" />
                <rect x="0.00012207" y="1.45158" width="1.45166" height="1.45166" />
                <rect x="0.00012207" y="2.90349" width="1.45166" height="1.45166" />
                <rect x="0.00012207" y="4.35493" width="1.45166" height="1.45166" />
                <rect x="2.90344" y="7.25829" width="1.45166" height="1.45166" />
                <rect x="1.45178" y="5.80638" width="1.45166" height="1.45166" />
                <rect x="4.3551" y="8.71021" width="1.45166" height="1.45166" />
                <rect x="5.80664" y="10.1617" width="1.45166" height="1.45166" />
                <rect x="7.2583" y="11.6136" width="1.45166" height="1.45166" />
            </g>
            </svg>
            <svg v-show="isFav" width="32" height="32" viewBox="0 0 20 16" aria-hidden="true" class="icon-filled">
            <g>
                <rect x="10.6667" y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4446" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="14.2222" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="16" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="8.88892" y="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="7.11108" y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.3335" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="1.77783" y="0.000133514" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="1.77783" y="1.77797" width="5.33325" height="5.33301" fill="#D18FA1"/>
                <rect x="12.4446" y="1.77797" width="5.33325" height="5.33301" fill="#D18FA1"/>
                <rect x="7.11108" y="3.55526" width="5.33325" height="8.88916" fill="#D18FA1"/>
                <rect x="17.7778" y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="17.7778" y="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="17.7778" y="5.33338" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="16" y="7.11109" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="14.2222" y="8.8888" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4446" y="10.6668" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="10.6667" y="12.4445" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect y="1.77771" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect y="3.55566" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect y="5.33338" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="3.55542" y="8.88881" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.33325" y="8.88881" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.33325" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4443" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="12.4443" y="8.88875" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="14.2224" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="1.77783" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="3.55542" y="7.11097" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="5.3335" y="10.6668" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="7.11108" y="12.4445" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="8.88892" y="14.2223" width="1.77778" height="1.77778" fill="#D18FA1"/>
                <rect x="8.88892" y="12.4445" width="1.77778" height="1.77778" fill="#D18FA1"/>
            </g>
            </svg>
           </button>
        </div>

        <div class="modal-body">
            <div class="modal-image-wrapper">
                <img
                    :src="imageSrc"
                    :alt="nameEN"
                    class="modal-image"
                    @error="handleImageError"
                >
            </div>

            <div class="modal-source-info">
                <p class="source-label">Image source:</p>
                <p class="source-name">äº¤é€šéƒ¨è§€å…‰ç½²</p>
            </div>

            <div class="modal-details">
                <div class="modal-description">
                    <p v-if="structuredDetails.preface.length > 0">{{ structuredDetails.preface }}</p>
                    <p class="example-label">{{ structuredDetails.exampleTag }}</p>
                    <ul>
                        <li v-for="(item, index) in structuredDetails.listItems" :key="index">
                            {{ item }}
                        </li>
                    </ul>
                </div>
            </div>

            <ButtonOk
            text="ok!"
            type="ok"
            @click=closeModal()
        />
        </div>
    </div>
</div>
</template>


<script setup lang="ts">
import { ref, computed } from 'vue'
import { useFavorites } from '~/composables/useFavorites'

const props = withDefaults(defineProps<{
    item: {
        Code: string;
        Name_EN?: string;
        Name_CH?: string;
        City?: string;
        Details?: string;
        Img_source?: string;
    };
    showCH?: boolean;
}>(), {
    showCH: true
})

const { isFavorite, toggleFavorite } = useFavorites()

// --- åœ–ç‰‡è¼‰å…¥ç‹€æ…‹èˆ‡é‚è¼¯ ---
const defaultImage = ref('/images/fallback.jpg')
// è¿½è¹¤ç•¶å‰å˜—è©¦çš„å‰¯æª”åï¼Œåˆå§‹ç‚º .jpg
const currentImageExt = ref('.jpg')
// ğŸ¯ æ ¹æ“š item.Code å’Œç•¶å‰å‰¯æª”åè¨ˆç®—åœ–ç‰‡è·¯å¾‘
const imageSrc = computed(() => {
    const code = props.item.Code;
    // ç¬¬ä¸€æ¬¡ç¸½æ˜¯å˜—è©¦ currentImageExt (é è¨­æ˜¯ .jpg)
    const path = `/images/${code}${currentImageExt.value}`;
    // console.log(`[WishCard DEBUG] Generated Image Path: ${path}`);
    return path;
})

// ğŸ¯ ä¿®æ­£ handleImageError å‡½æ•¸ï¼Œå¯¦ç¾å˜—è©¦é‚è¼¯
const handleImageError = (event: Event) => {
    const target = event.target as HTMLImageElement

    if (currentImageExt.value === '.jpg') {
        // ç¬¬ä¸€æ¬¡å¤±æ•—ï¼šå¾ .jpg åˆ‡æ›åˆ° .pngï¼Œä¸¦å¼·åˆ¶é‡æ–°è¼‰å…¥åœ–ç‰‡
        currentImageExt.value = '.png'
        console.warn(`Image failed with .jpg for ${props.item.Code}. Retrying with .png.`);

    } else if (currentImageExt.value === '.png') {
        // ç¬¬äºŒæ¬¡å¤±æ•— (pngä¹Ÿå¤±æ•—)ï¼šåˆ‡æ›åˆ°é è¨­åœ–ç‰‡ï¼Œä¸¦é˜²æ­¢å†æ¬¡è§¸ç™¼éŒ¯èª¤
        target.src = defaultImage.value
        currentImageExt.value = '' // æ¸…ç©ºä»¥é˜²æ­¢ç„¡é™å¾ªç’°
        console.error(`Image failed with .png for ${props.item.Code}. Using default placeholder.`);
    }
}

// --- è³‡è¨Šé¡¯ç¤ºèˆ‡è¨ˆç®— ---
const isFav = computed(() => isFavorite(props.item.Code))
const nameEN = computed(() => {
    return (props.item.Name_EN || props.item.Code).replace('(Taiwan)', '').trim()
})
const nameCH = computed(() => props.item.Name_CH)

// ğŸ¯ æ¨¡æ…‹æ¡†ç‹€æ…‹
const showModal = ref(false)

const openModal = () => {
    showModal.value = true
    // é–å®š body æ»¾å‹• (å¯é¸ï¼Œæä¾›æ›´å¥½çš„ UX)
    document.body.style.overflow = 'hidden'
    // é‡è¨­åœ–ç‰‡å˜—è©¦ç‹€æ…‹ï¼Œç¢ºä¿æ¯æ¬¡æ‰“é–‹ modal éƒ½å¾ .jpg é–‹å§‹å˜—è©¦
    currentImageExt.value = '.jpg';
}

const closeModal = () => {
    showModal.value = false
    document.body.style.overflow = '' // è§£é– body æ»¾å‹•
}

// --- ğŸ¯ çµæ§‹åŒ–è©³ç´°è³‡è¨Šé‚è¼¯ (å–ä»£ v-html) ---
const structuredDetails = computed(() => {
    const details = props.item.Details;
    if (!details) {
        return { preface: '', exampleTag: '', listItems: [] };
    }

    const exampleRegex = /(Examples?:)/i;
    const match = details.match(exampleRegex);

    if (!match) {
        // å¦‚æœæ²’æœ‰æ‰¾åˆ° Examples:ï¼Œå°‡æ‰€æœ‰å…§å®¹è¦–ç‚º preface
        return { preface: details, exampleTag: '', listItems: [] };
    }

    const [exampleTag] = match;
    const tagIndex = details.indexOf(exampleTag);

    const preface = details.substring(0, tagIndex).trim();
    const examplesRaw = details.substring(tagIndex + exampleTag.length).trim();

    // è™•ç†èˆ‰ä¾‹åˆ—è¡¨ï¼šä½¿ç”¨å¥è™Ÿå’Œç©ºæ ¼ä¾†åˆ†éš”é …ç›®
    let listItems = examplesRaw
        .split(/[.]\s/)
        .map(item => item.trim())
        .filter(item => item.length > 0);


    if (listItems.length > 0) {
        // ç¢ºä¿åˆ—è¡¨é …ç›®æœ‰é©ç•¶çš„çµæŸæ¨™é»
        listItems = listItems.map(item => {
            let finalItem = item;
            // å¦‚æœé …ç›®ä¸ä»¥å¥è™Ÿã€å•è™Ÿæˆ–æ„Ÿå˜†è™Ÿçµå°¾ï¼Œå‰‡è£œä¸Šå¥è™Ÿ
            if (finalItem.length > 0 && !/[.?!]$/.test(finalItem)) {
                finalItem += '.';
            }
            return finalItem;
        });

        // å¦‚æœåŸå§‹å­—ä¸²ä»¥å¥è™Ÿçµå°¾ï¼Œä¸” listItems çš„æœ€å¾Œä¸€é …è¢« split æ‰äº†å¥è™Ÿï¼Œå‰‡è£œå›
        if (examplesRaw.endsWith('.')) {
             const lastIndex = listItems.length - 1;
             const lastItem = listItems[lastIndex];
             // å†æ¬¡æª¢æŸ¥æ˜¯å¦å·²ç¶“æœ‰å¥è™Ÿï¼Œé¿å…é‡è¤‡
             if (lastItem && !lastItem.endsWith('.')) {
                 listItems[lastIndex] += '.';
             }
        }
    }

    return {
        preface: preface,
        exampleTag: exampleTag,
        listItems: listItems
    };
});


</script>

<style scoped>
/* ================== ä¸»å¡ç‰‡æ¨£å¼ ================== */
.wish-card {
    position: relative;
    border: 4px solid var(--dark_blue);
    background: var(--blue); /* ğŸ¯ Reverted to blue */
    padding: 12px; /* ğŸ¯ Horizontal padding requested */
    cursor: pointer;
    box-sizing: border-box;
    overflow: hidden;
    transition: transform 0.15s ease-out;
    display: flex;
    flex-direction: column;
}

.wish-card:hover {
    transform: scale(1.03);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.card-image-wrapper {
    width: 100%;
    flex-grow: 1;
    aspect-ratio: 4 / 3;
    overflow: hidden;
}

.card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.card-topic {
    font-family: 'Jersey 15', sans-serif;
    font-size: 1.5rem; /* ğŸ¯ Reduced to avoid heart button collision */
    font-weight: normal; /* ğŸ¯ Not bold per user request */
    color: var(--vanilla);
    margin: 0 0 10px 0; /* ğŸ¯ Added bottom margin for spacing to image */
    line-height: 1.1;
    text-align: left; /* ğŸ¯ Left aligned per user request */
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.card-details {
    font-family: 'Inter', sans-serif;
    font-size: 0.9rem;
    color: #444;
    margin: 0;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2; /* ğŸ¯ Truncate to 2 lines */
    -webkit-box-orient: vertical;
    line-clamp: 2;
    overflow: hidden;
}

.modal-title {
    font-family: 'Jersey 15', sans-serif;
    font-size: 2.5rem;
    font-weight: normal; /* ğŸ¯ Not bold per user request */
    color: var(--dark_blue);
    margin: 0;
    line-height: 1.1;
    text-align: left; /* ğŸ¯ Left aligned per user request */
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.ch-name {
    font-family: 'Inter', sans-serif;
    font-size: 0.9rem;
    font-weight: normal;
    opacity: 0.8; /* ğŸ¯ Reverted to subtle transparency */
}

.modal-header .ch-name {
    color: var(--dark_blue);
    opacity: 0.7;
    font-size: 1.2rem;
}

/* ================== æ„›å¿ƒæŒ‰éˆ• (å¾®èª¿) ================== */
.heart-btn {
    color: var(--vanilla); /* ğŸ¯ Reverted to vanilla */
    background-color: transparent;
    position: absolute; /* å›ºå®šåœ¨å¡ç‰‡å³ä¸Šè§’ */
    top: 6px;
    right: 6px;
    z-index: 10;
    border: none;
    padding: 4px;
    cursor: pointer;
    transition: all 0.2s;
}

/* é€™æ˜¯é‡å°ç©ºå¿ƒæ„›å¿ƒ (icon-outline) å…§çš„åœ–å½¢å…ƒç´  */
.icon-outline rect {
    fill: currentColor; /* ğŸ’¡ é—œéµ: å¼·åˆ¶ä½¿ç”¨çˆ¶å±¤ (button) çš„ color å€¼ */
}

/* ================== æ‡¸æµ®æ¨¡æ…‹æ¡†æ¨£å¼ (èƒŒæ™¯) ================== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8); /* åŠé€æ˜é»‘è‰²èƒŒæ™¯ */
    z-index: 9000;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

/* ================== æ‡¸æµ®æ¨¡æ…‹æ¡†æ¨£å¼ (å¡ç‰‡æœ¬èº«) ================== */
.modal-content {
    background: var(--vanilla); /* æ·ºè‰²èƒŒæ™¯ */
    border: 8px solid var(--dark_blue);
    flex-direction: column;
    max-width: 600px;
    width: 100%;
    max-height: 90vh; /* é™åˆ¶é«˜åº¦åœ¨è¦–çª—å…§ */
    overflow: hidden; /* ğŸ¯ Fix: Hide overflow on the main container, let body scroll if needed */
    position: relative;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
}


/* ======= æ‡¸æµ®å¡ç‰‡æ¨™é¡Œ ======= */
.modal-header {
    background: var(--blue);
    color: var(--vanilla);
    padding: 15px 40px; /* ğŸ¯ Unified horizontal padding */
    position: relative;
}

.modal-city {
    margin: 0 0 10px 0;
    font-size: 1.2rem;
}

/* ======= æ‡¸æµ®å¡ç‰‡åœ–ç‰‡èˆ‡åœ–èªª ======= */
.modal-body {
    background: var(--vanilla); 
    color: var(--dark_blue);
    flex-grow: 1;
    overflow-y: auto; 
    /* ğŸ¯ æ¨¡æ“¬ Frame 73 çš„ Auto Layout */
    display: flex;
    flex-direction: column;
    font-size: 22;  /* 1.2rem; */
    line-height: 1.6;
    padding: 20px 40px; /* ğŸ¯ Unified horizontal padding */
    gap: 8px; /* ğŸ¯ æ¨¡æ“¬ Frame 73 çš„é–“è· */
}

/* ------------------- åœ–ç‰‡å€å¡Š (æ¨¡æ“¬ Component 1) ------------------- */
.modal-image-wrapper {
    width: 100%;
    height: 300px; /* ğŸ¯ Maintain improved height */
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    box-sizing: border-box;
    border-radius: 12px; /* ğŸ¯ Add rounded corners for a framed look */
    border: 2px solid var(--dark_blue); /* ğŸ¯ Add subtle border to define the image */
}

.modal-image {
    width: 100%;
    height: 100%;
    object-fit: cover; /* ğŸ¯ Fill the wider container edge-to-edge */
}

/* ------------------- åœ–ç‰‡ä¾†æº (æ¨¡æ“¬ Frame 76) ------------------- */
.modal-source-info {
    /* ğŸ¯ æ¨¡æ“¬ Frame 76 çš„ Flex row ä½ˆå±€ */
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 4px; /* ğŸ¯ æ¨¡æ“¬ Frame 76 çš„é–“è· */
    width: 100%; /* ç¢ºä¿ä½”æ»¿å¯¬åº¦ */
    background: none; /* ç§»é™¤è—è‰²èƒŒæ™¯ */
    border: none;
    padding: 0; /* ğŸ¯ Fix: Removed redundant padding as it is now on modal-body */
    margin-top: 4px;
}

.modal-source-info p {
    margin: 0;
}

.source-label {
    font-size: 14px; /* ğŸ¯ Fix: Increase font size */
    line-height: 1.4;
    letter-spacing: 0.02em;
    color: var(--blue); /* #5C8AA7 */
}

.source-name {
    /* Ch-Context-S (jf-openhuninn-2.1, 10px, Blue, Underline) */
    font-family: 'jf-openhuninn-2.1';
    font-size: 14px; /* ğŸ¯ Fix: Increase font size */
    line-height: 1.4;
    letter-spacing: 0.02em;
    text-decoration-line: underline;
    /* é€™é‚Šæ‡‰è©²è¦æ”¹æˆurlå§ */
    color: var(--blue); /* #5C8AA7 */
}

/* ------------------- èªªæ˜å€å¡Š ------------------- */
.modal-details {
    flex-grow: 1;
    overflow: hidden; /* é˜²æ­¢å…§å®¹æº¢å‡º */
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    font-size: 1.2rem; /* èª¿å¤§ç´°ç¯€æ–‡å­—ï¼Œä¾‹å¦‚ 20px */
    line-height: 1.6;  /* å¢åŠ è¡Œè·ï¼Œé–±è®€æ›´èˆ’æœ */
}

.modal-description {
    overflow-y: auto;   /* è®“èªªæ˜å…§å®¹å¯ä»¥æ»¾å‹• */
    flex-grow: 0; 
    letter-spacing: 0.02em;
    color: var(--dark_blue);
    padding-right: 5px; /* é˜²æ­¢æ»¾å‹•æ¢æ“‹ä½æ–‡å­— */
}

.modal-description p {
    margin: 0 0 5px 0; /* è®“æ®µè½ä¹‹é–“æœ‰å°é–“è· */

}

.modal-description .example-label {
    margin-bottom: 0;
    font-weight: bold; /* è®“ Examples: æ¨™ç±¤æ›´çªå‡º */
}

.modal-description ul {
    /* ä¿æŒç€è¦½å™¨é è¨­çš„ list-style-type: disc (åœ“é») */
    list-style-type: disc; 
    
    /* èª¿æ•´å·¦é‚Šè·ï¼Œè®“é»é»æœ‰ç©ºé–“é¡¯ç¤º */
    padding-left: 20px; 
    margin: 5px 0 10px 0;
}

.modal-description li {
    margin-bottom: 5px; 
    line-height: 1.4;
    color: var(--dark_blue); /* ç¢ºä¿æ–‡å­—é¡è‰²æ­£ç¢º */
}
</style>
